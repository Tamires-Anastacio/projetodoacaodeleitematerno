CREATE DATABASE sistema;

use sistema ;

CREATE TABLE usuario (
id_user int PRIMARY KEY ,
cpf varchar(8) not null UNIQUE,
nome_completo varchar(255) not null,
cidade varchar(100) not null,
data_nascimento date not null,
telefone char(15) not null unique,
email varchar(100) not null unique,
uf char(2) not null,
tipo_user varchar(10) not null,
data_cadastro datetime
);

CREATE TABLE mensagem (
id_mensagem int PRIMARY KEY ,
data_envio datetime not null,
id_remetente int not null,
conteudo text not null,
id_destinatario int not null
);

CREATE TABLE instituicao (
id_instituicao int PRIMARY KEY ,
nome varchar(255) not null,
certificacao text not null,
cidade varchar(100) not null,
num int not null,
uf char(2) not null,
rua varchar(100) not null
);

CREATE TABLE doacao (
id_doacao int PRIMARY KEY ,
observacao varchar(255) not null,
id_doadora int not null,
status varchar(15) not null,
id_receptora int not null,
id_instituicao int not null
);

CREATE TABLE tipo_leite (
id_tipo int PRIMARY KEY ,
nome varchar(100) not null,
descricao varchar(255) not null

);

CREATE TABLE envia (
id_user int not null,
id_mensagem int not null,
FOREIGN KEY(id_user) REFERENCES usuario (id_user),
FOREIGN KEY(id_mensagem) REFERENCES mensagem (id_mensagem)
);

CREATE TABLE solicitacao (
id_user int not null,
id_instituicao int not null,
FOREIGN KEY(id_user) REFERENCES usuario (id_user) ,
FOREIGN KEY(id_instituicao) REFERENCES instituicao (id_instituicao)
);

CREATE TABLE realiza (
id_user int not null,
id_doacao int not null,
FOREIGN KEY(id_user) REFERENCES usuario (id_user) ,
FOREIGN KEY(id_doacao) REFERENCES doacao (id_doacao)
);

CREATE TABLE possui (
id_tipo int not null,
id_doacao int not null,
FOREIGN KEY(id_tipo) REFERENCES tipo_leite (id_tipo),
FOREIGN KEY(id_doacao) REFERENCES doacao (id_doacao)
);

CREATE TABLE recebe (
id_instituicao int not null,
id_doacao int not null,
FOREIGN KEY(id_instituicao) REFERENCES instituicao (id_instituicao) ,
FOREIGN KEY(id_doacao) REFERENCES doacao (id_doacao)
)

